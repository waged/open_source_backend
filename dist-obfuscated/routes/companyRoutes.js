'use strict';function a9_0x4dd7(_0x291f20,_0x37853b){const _0x5c310f=a9_0x5c31();return a9_0x4dd7=function(_0x4dd782,_0x22acc0){_0x4dd782=_0x4dd782-0x1ac;let _0xf95e5c=_0x5c310f[_0x4dd782];return _0xf95e5c;},a9_0x4dd7(_0x291f20,_0x37853b);}const a9_0x3cb617=a9_0x4dd7;(function(_0x331549,_0x3f5c10){const _0x106171=a9_0x4dd7,_0x1809cd=_0x331549();while(!![]){try{const _0x43c0af=-parseInt(_0x106171(0x1f2))/0x1+parseInt(_0x106171(0x1dc))/0x2*(parseInt(_0x106171(0x1ae))/0x3)+-parseInt(_0x106171(0x1e5))/0x4*(parseInt(_0x106171(0x205))/0x5)+parseInt(_0x106171(0x1db))/0x6+-parseInt(_0x106171(0x1f5))/0x7+-parseInt(_0x106171(0x1b2))/0x8*(parseInt(_0x106171(0x1b9))/0x9)+parseInt(_0x106171(0x1b8))/0xa*(parseInt(_0x106171(0x1e0))/0xb);if(_0x43c0af===_0x3f5c10)break;else _0x1809cd['push'](_0x1809cd['shift']());}catch(_0x449509){_0x1809cd['push'](_0x1809cd['shift']());}}}(a9_0x5c31,0x81af0));var __awaiter=this&&this[a9_0x3cb617(0x1b3)]||function(_0x31bd9c,_0x5f0288,_0x160259,_0x2f46d4){function _0x499eb7(_0x1d7b97){return _0x1d7b97 instanceof _0x160259?_0x1d7b97:new _0x160259(function(_0x494c22){_0x494c22(_0x1d7b97);});}return new(_0x160259||(_0x160259=Promise))(function(_0x36346a,_0x39b4b7){const _0x49ce20=a9_0x4dd7;function _0x4fe10e(_0x502fe5){const _0x477ff4=a9_0x4dd7;try{_0x1cbe42(_0x2f46d4[_0x477ff4(0x1fa)](_0x502fe5));}catch(_0x4433de){_0x39b4b7(_0x4433de);}}function _0x352cc9(_0xf2ad25){const _0x274c67=a9_0x4dd7;try{_0x1cbe42(_0x2f46d4[_0x274c67(0x215)](_0xf2ad25));}catch(_0x3e5e2d){_0x39b4b7(_0x3e5e2d);}}function _0x1cbe42(_0x493543){const _0x17d4e1=a9_0x4dd7;_0x493543['done']?_0x36346a(_0x493543[_0x17d4e1(0x1ed)]):_0x499eb7(_0x493543[_0x17d4e1(0x1ed)])[_0x17d4e1(0x1d3)](_0x4fe10e,_0x352cc9);}_0x1cbe42((_0x2f46d4=_0x2f46d4[_0x49ce20(0x1ee)](_0x31bd9c,_0x5f0288||[]))['next']());});},__rest=this&&this[a9_0x3cb617(0x1af)]||function(_0x2d12f9,_0xa9f339){const _0x3fd335=a9_0x3cb617;var _0xef0985={};for(var _0xecdf5 in _0x2d12f9)if(Object['prototype'][_0x3fd335(0x1e8)][_0x3fd335(0x1da)](_0x2d12f9,_0xecdf5)&&_0xa9f339['indexOf'](_0xecdf5)<0x0)_0xef0985[_0xecdf5]=_0x2d12f9[_0xecdf5];if(_0x2d12f9!=null&&typeof Object['getOwnPropertySymbols']===_0x3fd335(0x204))for(var _0x514fee=0x0,_0xecdf5=Object['getOwnPropertySymbols'](_0x2d12f9);_0x514fee<_0xecdf5['length'];_0x514fee++){if(_0xa9f339[_0x3fd335(0x1ef)](_0xecdf5[_0x514fee])<0x0&&Object['prototype']['propertyIsEnumerable'][_0x3fd335(0x1da)](_0x2d12f9,_0xecdf5[_0x514fee]))_0xef0985[_0xecdf5[_0x514fee]]=_0x2d12f9[_0xecdf5[_0x514fee]];}return _0xef0985;},__importDefault=this&&this[a9_0x3cb617(0x1f8)]||function(_0x82e8a9){const _0x53d7ac=a9_0x3cb617;return _0x82e8a9&&_0x82e8a9[_0x53d7ac(0x210)]?_0x82e8a9:{'default':_0x82e8a9};};Object[a9_0x3cb617(0x1d0)](exports,'__esModule',{'value':!![]});const express_1=__importDefault(require(a9_0x3cb617(0x1cd))),Company_1=require(a9_0x3cb617(0x1e9)),authorise_1=__importDefault(require(a9_0x3cb617(0x217))),error_handler_1=require(a9_0x3cb617(0x1c4)),multer_1=__importDefault(require(a9_0x3cb617(0x1d5))),path_1=__importDefault(require(a9_0x3cb617(0x208))),fs_1=__importDefault(require('fs')),router=express_1[a9_0x3cb617(0x1bf)][a9_0x3cb617(0x1c6)](),storageDir=path_1[a9_0x3cb617(0x1bf)][a9_0x3cb617(0x20a)](a9_0x3cb617(0x203)),storage=multer_1['default']['diskStorage']({'destination':(_0x9b9b0b,_0x1a5135,_0x302787)=>{const _0xb4d6ef=a9_0x3cb617,_0x4178e4=path_1[_0xb4d6ef(0x1bf)]['join'](__dirname,_0xb4d6ef(0x1c2));fs_1[_0xb4d6ef(0x1bf)]['mkdirSync'](_0x4178e4,{'recursive':!![]}),_0x302787(null,storageDir);},'filename':(_0x5e4e1b,_0x9c88a8,_0x59fab1)=>{const _0xdcb65b=a9_0x3cb617,_0x34b03b=Date[_0xdcb65b(0x1be)]()+'-'+Math['round'](Math['random']()*0x3b9aca00),_0x41db95=path_1[_0xdcb65b(0x1bf)]['extname'](_0x9c88a8[_0xdcb65b(0x20f)]);_0x59fab1(null,'image-'+_0x34b03b+_0x41db95);}}),upload=(0x0,multer_1[a9_0x3cb617(0x1bf)])({'storage':storage});router[a9_0x3cb617(0x20c)]('/add',authorise_1[a9_0x3cb617(0x1bf)],(_0x4c4a1b,_0xb07a63)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x370f9c=a9_0x3cb617;try{const {name:_0x762328,commercialName:_0x41a1ec,slogan:_0x2e2a27,vat:_0x61ffa6,category:_0x5b8d87,industry:_0x11e71d,imgIds:_0x49a37f,backgroundImg:_0x3a305d,mobile:_0x308a8c,address:_0x1c0be7,phone:_0x4b0632,employees:_0x27a98a}=_0x4c4a1b['body'],_0x3a7270=_0x4c4a1b[_0x370f9c(0x1c7)],_0x5abaa7=yield Company_1[_0x370f9c(0x1de)][_0x370f9c(0x1ce)]({'name':_0x762328});if(_0x5abaa7){error_handler_1[_0x370f9c(0x1f1)][_0x370f9c(0x1d4)](_0xb07a63,_0x370f9c(0x1b1),0x190);return;}const _0x5623fc=new Company_1[(_0x370f9c(0x1de))]({'ownerID':_0x3a7270,'name':_0x762328,'commercialName':_0x41a1ec,'slogan':_0x2e2a27,'vat':_0x61ffa6,'category':_0x5b8d87,'industry':_0x11e71d,'imgIds':_0x49a37f,'backgroundImg':_0x3a305d,'mobile':_0x308a8c,'address':_0x1c0be7,'phone':_0x4b0632,'employees':_0x27a98a});yield _0x5623fc[_0x370f9c(0x1c1)](),error_handler_1['ResponseHandler'][_0x370f9c(0x1d8)](_0xb07a63,_0x5623fc,_0x370f9c(0x1b6));}catch(_0x2be15a){error_handler_1['ResponseHandler'][_0x370f9c(0x1d7)](_0xb07a63,_0x2be15a);}})),router[a9_0x3cb617(0x1f7)](a9_0x3cb617(0x1b0),authorise_1['default'],(_0x342f1d,_0x113e95)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x562238=a9_0x3cb617;try{const _0x5a9462=_0x342f1d['params']['id'],_0x138152=_0x342f1d[_0x562238(0x218)],{address:_0x4ae3d2,phone:_0x4746f9,employees:_0x231619}=_0x138152,_0x44f23a=__rest(_0x138152,[_0x562238(0x202),'phone',_0x562238(0x1b4)]),_0x1cc2e4=_0x342f1d['userID'],_0x1b4224=yield Company_1[_0x562238(0x1de)][_0x562238(0x1ce)]({'_id':_0x5a9462});if(!_0x1b4224){error_handler_1[_0x562238(0x1f1)]['notFound'](_0x113e95,_0x562238(0x1e1));return;}if(_0x1b4224[_0x562238(0x1f9)]!==_0x1cc2e4){error_handler_1[_0x562238(0x1f1)][_0x562238(0x1d4)](_0x113e95,_0x562238(0x1d2),0x193);return;}const _0x469fff=Array[_0x562238(0x1e6)](_0x4ae3d2)?_0x4ae3d2[_0x562238(0x1b7)](_0x483ccc=>JSON[_0x562238(0x1d9)](_0x483ccc)):[],_0x2d37f0=Array['isArray'](_0x4746f9)?_0x4746f9[_0x562238(0x1b7)](_0x1db22d=>JSON[_0x562238(0x1d9)](_0x1db22d)):[],_0x1c9e7d=Array[_0x562238(0x1e6)](_0x231619)?_0x231619['map'](_0x5d29f4=>JSON[_0x562238(0x1d9)](_0x5d29f4)):[],_0x407cd8=yield Company_1[_0x562238(0x1de)]['findOneAndUpdate']({'_id':_0x5a9462},Object[_0x562238(0x212)](Object['assign']({},_0x44f23a),{'address':_0x469fff,'phone':_0x2d37f0,'employees':_0x1c9e7d}),{'new':!![]});error_handler_1[_0x562238(0x1f1)][_0x562238(0x1d8)](_0x113e95,_0x407cd8,'Company\x20updated\x20successfully');}catch(_0x5ab6fd){error_handler_1['ResponseHandler']['internalServerError'](_0x113e95,_0x5ab6fd);}})),router['delete'](a9_0x3cb617(0x1bb),authorise_1['default'],(_0x25b1cc,_0x57fe3b)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x4510d4=a9_0x3cb617;try{const _0x4d0f0f=_0x25b1cc[_0x4510d4(0x1e2)]['id'],_0x28aa75=_0x25b1cc[_0x4510d4(0x1c7)],_0x85c816=yield Company_1['Company']['findOne']({'_id':_0x4d0f0f});if(!_0x85c816){error_handler_1[_0x4510d4(0x1f1)]['notFound'](_0x57fe3b,_0x4510d4(0x1e1));return;}if(_0x85c816[_0x4510d4(0x1f9)]!==_0x28aa75){error_handler_1['ResponseHandler'][_0x4510d4(0x1d4)](_0x57fe3b,_0x4510d4(0x20e),0x193);return;}yield Company_1[_0x4510d4(0x1de)][_0x4510d4(0x1cb)]({'_id':_0x4d0f0f}),error_handler_1[_0x4510d4(0x1f1)][_0x4510d4(0x1d8)](_0x57fe3b,null,_0x4510d4(0x214));}catch(_0x573c6d){error_handler_1[_0x4510d4(0x1f1)]['internalServerError'](_0x57fe3b,_0x573c6d);}})),router[a9_0x3cb617(0x20d)](a9_0x3cb617(0x1f6),authorise_1[a9_0x3cb617(0x1bf)],(_0xaf3b65,_0x818a58)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x423dbb=a9_0x3cb617;try{const {userID:_0x2ffcb8,email:_0x554d2f}=_0xaf3b65;if(!_0x2ffcb8&&!_0x554d2f){error_handler_1[_0x423dbb(0x1f1)][_0x423dbb(0x1fc)](_0x818a58,_0x423dbb(0x1f0));return;}const _0x42dc33={'ownerID':_0x2ffcb8},_0x4baaec=yield Company_1[_0x423dbb(0x1de)][_0x423dbb(0x1c8)](_0x42dc33);if(!_0x4baaec||_0x4baaec[_0x423dbb(0x1c0)]===0x0){error_handler_1[_0x423dbb(0x1f1)][_0x423dbb(0x216)](_0x818a58,_0x423dbb(0x1d6));return;}error_handler_1[_0x423dbb(0x1f1)][_0x423dbb(0x1d8)](_0x818a58,_0x4baaec,_0x423dbb(0x1fe));}catch(_0xcfd914){error_handler_1[_0x423dbb(0x1f1)][_0x423dbb(0x1d7)](_0x818a58,_0xcfd914);}})),router[a9_0x3cb617(0x20c)](a9_0x3cb617(0x1cc),authorise_1['default'],upload[a9_0x3cb617(0x1c9)]([{'name':a9_0x3cb617(0x219),'maxCount':0x5},{'name':a9_0x3cb617(0x1ea),'maxCount':0x1}]),(_0x416faa,_0x59b7da)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x5fa27=a9_0x3cb617;try{const {companyID:_0x2cdb48}=_0x416faa[_0x5fa27(0x1e2)],_0x49f8c2=_0x416faa['userID'];if(!_0x416faa[_0x5fa27(0x1f4)]){error_handler_1[_0x5fa27(0x1f1)][_0x5fa27(0x216)](_0x59b7da,_0x5fa27(0x1ec));return;}const _0xae5eb5=yield Company_1[_0x5fa27(0x1de)][_0x5fa27(0x1ce)]({'_id':_0x2cdb48,'ownerID':_0x49f8c2});if(!_0xae5eb5){error_handler_1[_0x5fa27(0x1f1)][_0x5fa27(0x1fc)](_0x59b7da,_0x5fa27(0x1e7));return;}const _0x15dc78=_0x416faa['files'];if(_0x15dc78[_0x5fa27(0x219)]&&_0x15dc78[_0x5fa27(0x219)]['length']>0x0){const _0x5d3ae4=_0x15dc78[_0x5fa27(0x219)][_0x5fa27(0x1b7)](_0x3ce7c5=>_0x3ce7c5[_0x5fa27(0x1ff)]);_0xae5eb5[_0x5fa27(0x1ba)]=[..._0xae5eb5[_0x5fa27(0x1ba)]||[],..._0x5d3ae4];}_0x15dc78[_0x5fa27(0x1ea)]&&_0x15dc78[_0x5fa27(0x1ea)][_0x5fa27(0x1c0)]>0x0&&(_0xae5eb5[_0x5fa27(0x207)]=_0x15dc78[_0x5fa27(0x1ea)][0x0][_0x5fa27(0x1ff)]),yield _0xae5eb5[_0x5fa27(0x1c1)](),error_handler_1[_0x5fa27(0x1f1)][_0x5fa27(0x1d8)](_0x59b7da,_0xae5eb5,_0x5fa27(0x1e3));}catch(_0x343aa8){console[_0x5fa27(0x1d4)](_0x5fa27(0x1fb),_0x343aa8),error_handler_1[_0x5fa27(0x1f1)][_0x5fa27(0x1d7)](_0x59b7da,_0x5fa27(0x1fd)+_0x343aa8);}})),router[a9_0x3cb617(0x1df)]('/image/:companyID/:filename',authorise_1['default'],(_0x38bab9,_0x17c07f)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x41607f=a9_0x3cb617;try{const {companyID:_0x5a5bea,filename:_0x5b9376}=_0x38bab9[_0x41607f(0x1e2)],_0x152ecc=_0x38bab9[_0x41607f(0x1c7)],_0x183a90=yield Company_1['Company']['findOne']({'_id':_0x5a5bea,'ownerID':_0x152ecc});if(!_0x183a90){error_handler_1[_0x41607f(0x1f1)]['notFound'](_0x17c07f,_0x41607f(0x200));return;}if(!_0x183a90[_0x41607f(0x1ba)]||!_0x183a90[_0x41607f(0x1ba)][_0x41607f(0x1cf)](_0x5b9376)){error_handler_1[_0x41607f(0x1f1)][_0x41607f(0x216)](_0x17c07f,_0x41607f(0x1c3));return;}const _0x5cf86d=path_1[_0x41607f(0x1bf)]['join'](__dirname,_0x41607f(0x1bd),_0x41607f(0x1ad),_0x5b9376);fs_1[_0x41607f(0x1bf)][_0x41607f(0x1b5)](_0x5cf86d,_0x53e89b=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x39422c=_0x41607f;if(_0x53e89b){console[_0x39422c(0x1d4)](_0x39422c(0x20b),_0x53e89b),error_handler_1['ResponseHandler'][_0x39422c(0x1d4)](_0x17c07f,_0x39422c(0x1eb)+_0x53e89b[_0x39422c(0x1bc)],0x19a);return;}let _0x24f6ce=![];_0x183a90[_0x39422c(0x1ba)]&&_0x183a90['imageIDs'][_0x39422c(0x1cf)](_0x5b9376)&&(_0x183a90[_0x39422c(0x1ba)]=_0x183a90['imageIDs']['filter'](_0x4f3d08=>_0x4f3d08!==_0x5b9376),_0x24f6ce=!![]);_0x183a90[_0x39422c(0x207)]===_0x5b9376&&(_0x183a90['backgroundImageID']='',_0x24f6ce=!![]);if(!_0x24f6ce){error_handler_1[_0x39422c(0x1f1)][_0x39422c(0x216)](_0x17c07f,'Image\x20not\x20associated\x20with\x20this\x20company');return;}yield _0x183a90[_0x39422c(0x1c1)](),error_handler_1[_0x39422c(0x1f1)]['success'](_0x17c07f,_0x5b9376,'Image\x20deleted\x20successfully');}));}catch(_0x343e18){console[_0x41607f(0x1d4)](_0x41607f(0x209),_0x343e18),error_handler_1[_0x41607f(0x1f1)][_0x41607f(0x1d7)](_0x17c07f,'Internal\x20server\x20error:\x20'+_0x343e18);}})),router['get'](a9_0x3cb617(0x1cc),(_0x1b982c,_0x307a8b)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x3200e0=a9_0x3cb617;try{const {companyID:_0x133ed7}=_0x1b982c[_0x3200e0(0x1e2)],_0x1c04cc=yield Company_1['Company'][_0x3200e0(0x1ce)]({'_id':_0x133ed7});if(!_0x1c04cc){error_handler_1[_0x3200e0(0x1f1)][_0x3200e0(0x1fc)](_0x307a8b);return;}const _0x27f7dd=_0x1c04cc[_0x3200e0(0x1ba)]||[],_0xe45ebc=_0x27f7dd['map'](_0x590636=>{const _0x496572=_0x3200e0;return _0x1b982c[_0x496572(0x201)]+_0x496572(0x1e4)+_0x1b982c[_0x496572(0x20d)](_0x496572(0x1c5))+_0x496572(0x206)+_0x590636;});error_handler_1['ResponseHandler'][_0x3200e0(0x1d8)](_0x307a8b,_0xe45ebc);}catch(_0x1e0bae){console['error'](_0x3200e0(0x211),_0x1e0bae),error_handler_1[_0x3200e0(0x1f1)][_0x3200e0(0x1d7)](_0x307a8b,_0x3200e0(0x1fd)+_0x1e0bae);}})),router['get'](a9_0x3cb617(0x1d1),(_0x1af5e2,_0x4b3746)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x220925=a9_0x3cb617;try{const {companyID:_0x1a1c11,imageName:_0x233b69}=_0x1af5e2[_0x220925(0x1e2)],_0x47c220=yield Company_1[_0x220925(0x1de)]['findOne']({'_id':_0x1a1c11});if(!_0x47c220){error_handler_1['ResponseHandler'][_0x220925(0x216)](_0x4b3746,'Product\x20not\x20found\x20or\x20unauthorized');return;}if(!_0x47c220[_0x220925(0x1ba)]||!_0x47c220[_0x220925(0x1ba)][_0x220925(0x1cf)](_0x233b69)){error_handler_1['ResponseHandler']['notFound'](_0x4b3746,_0x220925(0x1f3));return;}const _0x2f4d8a=path_1[_0x220925(0x1bf)][_0x220925(0x213)](__dirname,_0x220925(0x1bd),'storage',_0x233b69);if(!fs_1['default']['existsSync'](_0x2f4d8a)){error_handler_1[_0x220925(0x1f1)][_0x220925(0x216)](_0x4b3746,_0x220925(0x1ac));return;}_0x4b3746['sendFile'](_0x2f4d8a);}catch(_0x201496){console['error'](_0x220925(0x1dd),_0x201496),error_handler_1[_0x220925(0x1f1)][_0x220925(0x1d7)](_0x4b3746,_0x220925(0x1ca)+_0x201496);}})),exports[a9_0x3cb617(0x1bf)]=router;function a9_0x5c31(){const _0x5edc4a=['__importDefault','ownerID','next','Image\x20Upload\x20Error:','unauthorized','Internal\x20server\x20error:\x20','Companies\x20retrieved\x20successfully','filename','Product\x20not\x20found\x20or\x20unauthorized','protocol','address','/storage_regal','function','3155remKIL','/storage/','backgroundImageID','path','Delete\x20Image\x20Error:','resolve','File\x20Deletion\x20Error:','post','get','Unauthorized\x20to\x20delete\x20this\x20company','originalname','__esModule','Get\x20Images\x20Error:','assign','join','Company\x20deleted\x20successfully','throw','notFound','../middlewares/authorise','body','images','Image\x20file\x20does\x20not\x20exist\x20on\x20the\x20server','storage','3JmNfQD','__rest','/edit/:id','Company\x20already\x20exists','1103272PVcACE','__awaiter','employees','unlink','Company\x20added\x20successfully','map','217190ICCfDF','63rYzmKs','imageIDs','/delete/:id','message','../..','now','default','length','save','../../../storage_regal','Image\x20not\x20associated\x20with\x20this\x20product','../handlers/error_handler','host','Router','userID','find','fields','Internal\x20server\x20error\x20:\x20','deleteOne','/images/:companyID','express','findOne','includes','defineProperty','/image/:companyID/:imageName','Unauthorized\x20to\x20edit\x20this\x20company','then','error','multer','No\x20companies\x20found\x20for\x20the\x20given\x20user','internalServerError','success','parse','call','111432ABFYoe','1680010CAmcsC','Get\x20Specific\x20Image\x20Error:','Company','delete','1265TvFSYZ','Company\x20not\x20found','params','Images\x20uploaded\x20successfully','://','4552aMZVON','isArray','Company\x20not\x20found\x20or\x20unauthorized','hasOwnProperty','../models/Company','backgroundImage','Failed\x20to\x20delete\x20the\x20file:\x20','No\x20images\x20uploaded','value','apply','indexOf','User\x20ID\x20or\x20email\x20is\x20required','ResponseHandler','382165JwjHUv','Image\x20not\x20found\x20in\x20this\x20product','files','5316304nZZdwN','/get','put'];a9_0x5c31=function(){return _0x5edc4a;};return a9_0x5c31();}